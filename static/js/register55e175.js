var basetool=$.fn.basetool,nano=$.fn.nano,CountryCodeDropdown=$.fn.countryCodeDropdown,nav=$.fn.nav,adapt_helper=$.fn.adapt_helper;adapt_helper.adaptHeader(),adapt_helper.adaptBodyWidth(),basetool.doIndexStatistic(),$.validator.addMethod("phone",function(e,t){e.length;return this.optional(t)||/^(((13[0-9]{1})|(15[0-9]{1}))+\d{8})$/.test(e)||/^(\d{3,4}-?)?\d{7,9}$/.test(e)},"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801");var $buyRegisterForm=$("#buy_register_form");function countdownSMS(e,t){if(t=t||$("#js_get_verify_code"),0<e){wait=!0;var o=e-1,s="\u91cd\u65b0\u53d1\u9001("+o+"S)";t.addClass("disabled"),t.text(s),timer=setTimeout(function(){countdownSMS(o,t)},1e3)}else wait=!1,t.removeClass("disabled"),t.text("\u83b7\u53d6\u9a8c\u8bc1\u7801"),clearTimeout(timer)}$buyRegisterForm.validate({debug:!0,onfocusout:function(e){$(e).valid()},unhighlight:function(e){$(e).siblings("label.error").eq(0).html("")},errorPlacement:function(e,t){t.siblings("label.error").eq(0).html(e.text()).show()},ignore:".ignore",rules:{},messages:{},submitHandler:function(e){if(""!=$.trim($("#cus_name").val()))if(""!=$.trim($("#cus_person").val())){var t=$("#cus_tel_show").val();if(""!=$.trim(t))if((86!=countryCode||/^1\d{10}$/.test(t))&&/^[0-9-+]+$/.test($.trim(t)))if($("#cus_tel").val("+"+countryCode+" "+t),""!=$.trim($("#cus_tel_verify_code").val())){var o=$buyRegisterForm.serialize();o=o+"&phone_vc="+$.trim($("#cus_tel_verify_code").val())+"&mobile="+$.trim(t)+"&area="+countryCode,$.ajax("/cgi-bin/bizmail_portal?action=record_cus&t=biz_rf_portal_mgr&ef=jsnew&resp_charset=UTF8&"+o,{dataType:"json",success:function(e){0==e.retcode?($(".dealer_add_form").html('<div class="registResContent"><span class="qy_indexIcon qy_indexIcon_succ_60 registResIcon"></span><p class="registResText">\u767b\u8bb0\u8d2d\u4e70\u4fe1\u606f\u63d0\u4ea4\u6210\u529f\uff0c\u6211\u4eec\u5c06\u572824\u5c0f\u65f6\u5185\u8054\u7cfb\u60a8\u3002</p></div>'),$(".index_content_register").css("height",440),basetool.logKvEx({type:"sell_on_line",item:"RegistBuy"}),basetool.logKvEx({type:"nosession_statistics",businame:"new_index",item:"dealer_add|click|register"}),!$("input[name='origin']")||"bds"!=$("input[name='origin']").val()&&"bdTab"!=$("input[name='origin']").val()||basetool.logKvEx({type:"nosession_statistics",businame:"baidu_promote",item:"bd|index|service|register|sum"}),$("input[name='origin']")&&"bdTab"==$("input[name='origin']").val()&&basetool.logKvEx({type:"nosession_statistics",businame:"baidu_promote",item:"bdTab|index|register|sum"})):("-205"==e.retcode?($("#cus_tel_verify_code").addClass("input_err"),$("#cus_tel_verify_code").parent("div").siblings("label.error").eq(0).html("\u624b\u673a\u9a8c\u8bc1\u7801\u9519\u8bef").show()):basetool.showErr(e.errmsg),changeimg())},error:function(e){basetool.showErr("\u63d0\u4ea4\u5931\u8d25\u8bf7\u91cd\u65b0\u63d0\u4ea4")}})}else $("#cus_tel_verify_code").siblings("label.error").eq(0).html("\u8bf7\u8f93\u5165\u624b\u673a\u9a8c\u8bc1\u7801").show();else $("#cus_tel_show").siblings("label.error").eq(0).html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801").show();else $("#cus_tel_show").siblings("label.error").eq(0).html("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801").show()}else $("#cus_person").siblings("label.error").eq(0).html("\u8bf7\u8f93\u5165\u8054\u7cfb\u4eba").show();else $("#cus_name").siblings("label.error").eq(0).html("\u8bf7\u8f93\u5165\u516c\u53f8\u6216\u7ec4\u7ec7\u540d\u79f0").show()}}),$(".js_register_submit").click(function(e){$(".js_register_submit").hasClass("disabled")||(e.preventDefault(),$buyRegisterForm.submit())}),$(".js_get_verify_code").click(function(e){if(!$(".js_get_verify_code").hasClass("disabled")){var t=$("#cus_tel_show").val();if((86!=countryCode||/^1\d{10}$/.test(t))&&/^[0-9-+]+$/.test($.trim(t)))new TencentCaptcha("2016770177",function(e){console.log("TencentCaptcha res = ",e),0==e.ret?(function t(e){countdownSMS(60,$("#js_get_verify_code")),$.ajax({url:"/cgi-bin/bizmail_portal?action=send_sms&type=17&t=biz_rf_portal_mgr&ef=jsnew&resp_charset=UTF8",data:{area:$.trim($(".js_countryCode").val()),mobile:$.trim($("#cus_tel_show").val()),ticket:encodeURIComponent(e.ticket),randstr:encodeURIComponent(e.randstr)},dataType:"JSON",success:function(e){"0"==e.retcode||("-101"==e.retcode?(basetool.showErr("\u64cd\u4f5c\u901f\u5ea6\u8fc7\u5feb\uff0c\u8bf71\u5206\u949f\u540e\u91cd\u65b0\u5c1d\u8bd5"),changeimg(),countdownSMS(0)):-202==e.retcode?(countdownSMS(0),changeimg()):-1e4==e.retcode?(basetool.showErr("\u8be5\u624b\u673a\u53f7\u7684\u9a8c\u8bc1\u7801\u83b7\u53d6\u6b21\u6570\u5df2\u5230\u8fbe\u6bcf\u65e5\u4e0a\u9650"),countdownSMS(0),changeimg(),$(".js_get_verify_code").addClass("disabled")):(basetool.showErr("\u9a8c\u8bc1\u7801\u53d1\u9001\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),changeimg(),countdownSMS(0)))},complete:function(){}})}(e),(new Image).src="/qy_mng_logic/reportKV?type=RegCaptcha&itemName=captcha_succ"):2==e.ret&&((new Image).src="/qy_mng_logic/reportKV?type=RegCaptcha&itemName=captcha_close")}).show();else $("#cus_tel_show").siblings("label.error").eq(0).html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801").show()}}),setInterval(function(){""!=$.trim($("#cus_name").val())&&""!=$.trim($("#cus_person").val())&&""!=$.trim($("#cus_tel_show").val())&&"\u83b7\u53d6\u9a8c\u8bc1\u7801"==$("#js_get_verify_code").text()?$(".js_get_verify_code").removeClass("disabled"):$(".js_get_verify_code").addClass("disabled"),""!=$.trim($("#cus_name").val())&&""!=$.trim($("#cus_person").val())&&""!=$.trim($("#cus_tel_show").val())&&""!=$.trim($("#cus_tel_verify_code").val())?$(".js_register_submit").removeClass("disabled"):$(".js_register_submit").addClass("disabled")},500);var city_data=$.fn.city_data;function initDropdown(){var t=this;this.countryCodeDropdown=new Dropdown({container:".js_countryCode_dropdown",dropDownClass:"qy_telInput_zipCode_input ",dropdownInputClass:"qy_inputText_Big",onChange:function(e){t.countryCodeDropdown.setText(e.value),countryCode=+e.value},onHide:function(){t.countryCodeDropdown.isValidCode(t.countryCodeDropdown.getText())?countryCode!=t.countryCodeDropdown.getText()&&t.countryCodeDropdown.setText(countryCode):t.countryCodeDropdown.setText(countryCode)}}),$.extend(this.countryCodeDropdown,CountryCodeDropdown),this.countryCodeDropdown.initialize(this.countryCodeDropdown.opt),t.countryCodeDropdown.selectByValue(countryCode),t.countryCodeDropdown.scrollToSelectedItem()}city_data.initProvCity($("#prov"),$("#city"));var countryCode=86;initDropdown(),$("#cus_tel_verify_code").on("blur",function(e){}).on("input propertychange focus keyup",function(e){""!=$.trim($("#cus_tel_verify_code").val())&&($("#cus_tel_verify_code").parent("div").siblings(".error").hide(),$("#cus_tel_verify_code").removeClass("input_err"))});